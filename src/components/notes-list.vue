<template>
  <div class="note-list mx-1">
    <div class="add-note row m-0 no-gutters" @click.stop="submitAddNote(1)">
      <p class="py-3 m-0 px-3 mx-3">
        <svg viewBox="0 0 1024 1024" width="15" height="15">
          <path xmlns="http://www.w3.org/2000/svg"
                d="M512.67794 65.291029C265.701966 65.004503 66.200236 263.518742 65.293587 510.472204c-0.916882 247.286036 198.739367 447.915449 446.048939 448.236767 247.38632 0.322341 447.196065-199.272509 447.366957-446.883957C958.882422 265.25734 759.426741 65.579601 512.67794 65.291029zM772.621251 544.93204c-0.64059 26.420743-15.491833 41.562605-41.989323 41.606607-47.989991 0.080841-95.982028 0.124843-143.972019 0.151449 0.01228 45.808302 0.017396 91.615581-0.026606 137.418766-0.033769 35.107589-13.380752 48.577369-48.030923 48.683792-19.839861 0.061398-39.694047 0.370437-59.528791-0.11154-26.414603-0.642636-41.552371-15.495926-41.596374-41.999556-0.079818-47.998177-0.12382-95.996354-0.150426-143.993508-47.941895-0.027629-95.882767-0.072655-143.826709-0.154519-26.546609-0.044002-41.48381-15.205307-42.060955-41.548278-0.478907-21.701255-0.385786-43.417859-0.038886-65.119113 0.438998-27.465538 15.230889-42.333154 42.967604-42.441625 47.653323-0.176009 95.307669-0.155543 142.959969-0.122797 0.027629-47.950082 0.072655-95.89914 0.154519-143.851269 0.041956-26.552749 15.20019-41.49302 41.537022-42.070164 21.694091-0.477884 43.408649-0.385786 65.103764-0.037862 27.460422 0.438998 42.323944 15.233959 42.432415 42.977837 0.176009 47.667649 0.155543 95.335299 0.122797 143.001925 45.796022-0.01228 91.591021-0.017396 137.38295 0.026606 35.100426 0.033769 48.565089 13.382798 48.671513 48.039109C772.796236 505.231853 773.105275 525.093203 772.621251 544.93204z"
                p-id="3098"/>
        </svg>
        新建文章
      </p>
    </div>
    <ul class="body p-0" >
      <li class="row  py-4 px-4 item no-gutters "
          :class="{'active': item.id === notesList[activeIndex].id}"
          v-for="(item, index) in notesList"
          v-bind:key="item.id"
          @click.stop="switchNote($event, index)">
        <!--文章发布状态-->
        <div class="col-2 text-left">
          <i class="icon-publish" v-if="item.isPublish">
            <svg viewBox="0 0 1024 1024" width="35px">
              <path style="fill: #ccbc8d"
                d="M721.6 173.4h-62.5v26.4c0 14.5-11.9 26.4-26.4 26.4s-26.4-11.9-26.4-26.4v-26.4h-194v26.4c0 14.5-11.9 26.4-26.5 26.4-14.5 0-26.4-11.9-26.4-26.4v-26.4h-62.5c-43.2 0-78.5 35.3-78.5 78.5v524.6c0 43.2 35.3 78.5 78.5 78.5h424.8c43.2 0 78.5-35.3 78.5-78.5V251.9c-0.1-43.2-35.4-78.5-78.6-78.5z m-38.7 254.3l-169 209.2c-4.7 5.8-11.1 9.2-17.9 10.5-9.5 3.5-20.6 2.1-29-4.7l-114.6-92.5c-12.8-10.3-14.8-29.2-4.5-42s29.2-14.8 42-4.5l93.6 75.6 152.8-189.2c10.3-12.8 29.2-14.8 42-4.5 12.9 10.4 14.9 29.3 4.6 42.1z"
                fill="" p-id="5539">
              </path></svg>
          </i>
          <i class="icon-no-publish" v-else>
            <svg viewBox="0 0 1024 1024" width="30px">
              <path style="fill:#666"
                    d="M554.666667 384V149.333333L789.333333 384M256 85.333333c-47.36 0-85.333333 37.973333-85.333333 85.333334v682.666666a85.333333 85.333333 0 0 0 85.333333 85.333334h512a85.333333 85.333333 0 0 0 85.333333-85.333334V341.333333l-256-256H256z"
                    fill="" p-id="5539">
              </path>
            </svg>
          </i>
        </div>

        <div class="col-8">
          <!--文章标题-->
          <div class="title">{{item.title}}</div>
          <!--文章简介-->
          <!--<div class="col-2" v-show="item.id === notesList[activeIndex].id">-->
          <!--</div>-->
        </div>

        <!--设置图标-->
        <div class="col-2 text-right">
          <svg viewBox="0 0 1024 1024" width="15" height="15" v-show="item.id === notesList[activeIndex].id"
               @click.stop="item.isDispSetting=true"
               @blur.stop="item.isDispSetting=false">
            <path style="fill:#555"
                  d="M905.86 428.021l-0.002 0-71.797-15.945c-5.594-17.868-12.887-34.998-21.324-51.473l38.849-64.668c14.509-23.2 21.803-57.282 0-79.129l-39.588-39.547c-10.662-10.708-24.994-15.206-39.461-15.206-14.985 0-30.151 4.895-41.465 12.759l-62.972 40.112c-16.343-8.477-33.384-15.731-51.125-21.499l-16.121-72.621c-4.806-26.654-28.1-55.492-58.989-55.492l-55.932 0c-30.897 0-49.815 29.276-55.932 55.93l-17.963 71.746c-18.917 6.03-37.143 13.761-54.445 22.897l-64.538-41.075c-11.361-7.865-26.481-12.759-41.512-12.759-14.42 0-28.752 4.497-39.46 15.206l-39.543 39.547c-21.848 21.846-14.507 55.93 0 79.128l40.854 68.078c-7.644 15.469-14.461 31.374-19.705 48.064l-71.75 15.946c-26.654 4.812-55.495 28.099-55.495 58.995l0 55.93c0 30.889 29.277 49.813 55.932 55.93l72.665 18.13c5.029 15.428 11.273 30.237 18.4 44.569l-40.899 68.165c-14.508 23.157-21.807 57.24 0 79.087l39.588 39.548c10.663 10.704 24.994 15.248 39.455 15.248 14.991 0 30.151-4.894 41.471-12.758l64.672-41.249c17.432 9.217 35.744 17.041 54.795 23.071l17.917 71.573c6.118 26.653 25.035 55.931 55.932 55.931l55.933 0c30.89 0 54.184-28.84 58.989-55.493l16.122-72.838c17.565-5.685 34.433-12.853 50.559-21.194l63.1 40.199c11.313 7.866 26.481 12.76 41.465 12.76 14.467 0 28.8-4.546 39.461-15.248l39.588-39.548c21.803-21.847 14.509-55.93 0-79.089l-38.89-64.757c7.819-15.38 14.596-31.371 20.055-47.976l72.671-18.132c26.655-6.115 55.932-25.039 55.932-55.93l0-55.93C961.354 456.121 932.516 432.833 905.86 428.021zM514.684 648.029c-74.593 0-135.333-60.562-135.333-134.931s60.739-134.889 135.333-134.889c74.588 0 135.287 60.52 135.287 134.889S589.272 648.029 514.684 648.029z"
                  p-id="2223" fill="#ffffff">
            </path>
          </svg>

          <ul class="setting-info p-0 bg-light" v-show="item.isDispSetting">
            <li class="modify px-3 py-2 ">
              <svg viewBox="0 0 1024 1024" width="15" height="15">
                <path
                  d="M365.702656 438.894592l292.552704 0 0-109.707264q0-60.567552-42.8544-103.421952t-103.421952-42.8544-103.421952 42.8544-42.8544 103.421952l0 109.707264zm475.398144 54.853632l0 329.121792q0 22.85568-15.998976 38.854656t-38.854656 15.998976l-548.53632 0q-22.85568 0-38.854656-15.998976t-15.998976-38.854656l0-329.121792q0-22.85568 15.998976-38.854656t38.854656-15.998976l18.284544 0 0-109.707264q0-105.136128 75.423744-180.559872t180.559872-75.423744 180.559872 75.423744 75.423744 180.559872l0 109.707264 18.284544 0q22.85568 0 38.854656 15.998976t15.998976 38.854656z"
                  p-id="2641"/>
                </path>
              </svg>
              <span href="#" @mousedown.stop="modifyNotebook(index)">设为私密</span>
            </li>

            <li class="delete px-3 py-2 ">
              <svg t="1517492385038" viewBox="0 0 1024 1024" p-id="3246" width="15" height="15">
                <path
                  d="M830.061986 353.817328l-29.966499 567.691393c-1.102101 20.853957-18.330484 37.20025-39.21821 37.20025L263.122723 958.708971c-20.887726 0-38.116109-16.346293-39.21821-37.20025l-29.966499-567.691393c-1.140986-21.659299 15.489786-40.144302 37.148062-41.289382 21.759583-1.049912 40.148395 15.493879 41.289382 37.148062l28.000728 530.491143 423.248653 0 28.000728-530.491143c1.150196-21.663392 19.760043-38.130436 41.289382-37.148062C814.5722 313.674049 831.202972 332.158029 830.061986 353.817328zM934.164972 222.37467c0 21.687952-17.58347 39.271422-39.271422 39.271422L129.10645 261.646092c-21.687952 0-39.271422-17.58347-39.271422-39.271422s17.58347-39.271422 39.271422-39.271422l215.991286 0L345.097736 94.743828c0-18.97926 12.656251-29.453822 31.634488-29.453822l270.526343 0c18.97926 0 31.643698 10.474562 31.643698 29.453822l0 88.360444 215.991286 0C916.581502 183.104271 934.164972 200.687742 934.164972 222.37467zM413.821957 183.104271l196.356087 0L610.178043 134.01525 413.821957 134.01525 413.821957 183.104271zM430.287977 821.260529c0.274246 0 0.546446 0 0.824785 0 18.974144 0 33.988092-18.252713 33.542954-37.225833l-9.985422-424.467411c-0.446162-18.975167-16.005532-34.476209-35.162848-34.0587-18.974144 0.446162-33.988092 15.930831-33.542954 34.904974l9.985422 425.364851C396.390959 804.474214 411.683247 821.260529 430.287977 821.260529zM592.20981 821.260529c18.600637 0 33.898041-15.779382 34.339086-34.475186l9.985422-423.901523c0.446162-18.974144-14.56881-34.94693-33.542954-35.393091-19.270902-0.278339-34.717709 14.45727-35.162848 33.42732l-9.985422 424.308799c-0.446162 18.975167 14.56881 36.033681 33.542954 36.033681C591.664388 821.260529 591.93761 821.260529 592.20981 821.260529z"
                  p-id="3247" fill="#707070"></path>
              </svg>
              <span href="#" @mousedown.stop="deleteNote(index)">删除文集</span>
            </li>
          </ul>
        </div>
      </li>
    </ul>
    <!--<ul class="body p-0" v-else></ul>-->
    <div class="add-on-down row m-0 no-gutters" @click.stop="submitAddNote(-1)">
      <p class="py-3 m-0 px-3 mx-3">
        <i class="font-weight-bold add-icon">+</i>
        在下方新建文章
      </p>
    </div>
  </div>
</template>

<script type="es6">
export default {
  props: {
    notesList: {
      type: Array,
      default: () => [],
    },
  },
  data() {
    return {
      activeIndex: 0, // 选中文章
    };
  },
  watch: {
  },
  created() {
  },
  methods: {
    /**
     * @description 添加文章，未发布状态
     * @param {sort}number——1:文章排在最前面，-1：文章排在最后面
     * @return
     */
    submitAddNote(sort) {
      this.$emit('submitAddNote', false, sort);  // false 表示的是未发表状态
    },
    /**
     * @description 切换文章
     * @param
     * @return
     */
    switchNote(e, index) {
      if (index !== this.activeIndex) {
        this.activeIndex = index;
        // 触发父组件的切换文章事件
        this.$emit('switchNote', index);
      }
    },
    /**
     * @description 修改文集
     * @param
     * @return
     */
    modifyNotebook(index) {
    },
    /**
     * @description 删除文集
     * @param
     * @return
     */
    deleteNote(index) {
      this.$confirm(`确认删除文章《${this.notesList[index].title}》，文章将被移动到回收站，您可以在那里恢复它。60天后将被彻底删除。`, '警告', {
        confirmButtonText: '确定',
        cancelButtonText: '取消',
        type: 'warning',
      }).then(() => {
        this.$emit('deleteNote', index);
      }).catch(() => {
        this.$message({
          type: 'info',
          message: '已取消删除',
          duration: 1000,
        });
      });
    },
  },
};
</script>

<style type="text/scss" lang="scss" scoped>
  .note-list {
    height: 100%;
    min-width: 350px;
    border-left: 1px solid #ccc;
    border-right: 1px solid #ccc;
    .add-note {
      border-bottom: 1px solid #ccc;
      &:hover {
        cursor: pointer;
      }
    }
    .note-content {
      height: 100%;
    }
    .body {
      > li {
        border-left: 5px solid transparent;
        border-bottom: 1px solid #ccc;
        position: relative;
        &:hover {
          cursor: pointer;
          background: #e6e6e6;
        }
        &.active {
          border-left: 5px solid #ea725d;
          background: #e6e6e6;
        }
        .setting-info {
          z-index: 10;
          position: absolute;
          top: 30px;
          left: -60px;
          width: 120px;
          border-radius: 4px;
          box-shadow: 0 5px 10px rgba(0, 0, 0, .2);
          > li {
            list-style: none;
            border-bottom: 1px solid #d9d9d9;
            &:hover {
              background: #666;
              color: #fff;
            }
            &:last-child {
              border-bottom: 1px solid transparent;
              &:hover {
                border-radius: 0 0 4px 4px;
              }
            }
            &:first-child {
              &:hover {
                border-radius: 4px 4px 0 0;
              }
            }
          }
          &:before {
            content: '';
            border-left: 9px solid transparent;
            border-right: 9px solid transparent;
            border-bottom: 9px solid #f8f9fa;
            position: absolute;
            top: -9px;
            right: 10px;
          }
        }
      }
    }
    .add-on-down {
      color: #999;
      line-height: 30px;
      font-size: 14px;
      .add-icon {
        font-style: normal;
        font-size: 16px;
      }
      &:hover {
        cursor: pointer;
        color: #333;
      }
    }
  }
</style>
